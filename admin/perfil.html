<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil do Usuário</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f9; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .profile-card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { color: #333; text-align: center; margin-bottom: 25px; }
        .form-group { margin-bottom: 20px; position: relative; }
        label { display: block; margin-bottom: 8px; color: #666; font-size: 14px; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 16px; transition: border 0.3s; }
        input:focus { border-color: #007bff; outline: none; }
        
        /* Estilo do botão de mostrar senha */
        .password-container { position: relative; }
        .toggle-password { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; background: none; border: none; font-size: 12px; color: #007bff; font-weight: bold; }
        
        button#saveBtn { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; transition: background 0.3s; }
        button#saveBtn:hover { background-color: #0056b3; }
        .message { margin-top: 15px; text-align: center; font-size: 14px; }
    </style>
</head>
<body>

<div class="profile-card">
    <h2>Editar Perfil</h2>
    <form id="profileForm">
        <div class="form-group">
            <label>Nome Social</label>
            <input type="text" id="nomeSocial" required>
        </div>
        <div class="form-group">
            <label>Usuário</label>
            <input type="text" id="usuario" required>
        </div>
        <div class="form-group">
            <label>Senha</label>
            <div class="password-container">
                <input type="password" id="senha" required>
                <button type="button" class="toggle-password" onclick="toggleSenha()">VER</button>
            </div>
        </div>
        <button type="submit" id="saveBtn">Salvar Alterações</button>
    </form>
    <div id="msg" class="message"></div>
</div>

<script>
    function toggleSenha() {
        const senhaInput = document.getElementById('senha');
        const btn = document.querySelector('.toggle-password');
        if (senhaInput.type === 'password') {
            senhaInput.type = 'text';
            btn.textContent = 'ESCONDER';
        } else {
            senhaInput.type = 'password';
            btn.textContent = 'VER';
        }
    }

    document.getElementById('profileForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const btn = document.getElementById('saveBtn');
        const msg = document.getElementById('msg');
        
        btn.disabled = true;
        btn.innerText = "Salvando...";

        const dados = {
            nomeSocial: document.getElementById('nomeSocial').value,
            usuario: document.getElementById('usuario').value,
            senha: document.getElementById('senha').value
        };

        // Chama a função do Google Apps Script
        google.script.run
            .withSuccessHandler(function(res) {
                msg.innerText = "Perfil atualizado com sucesso!";
                msg.style.color = "green";
                btn.disabled = false;
                btn.innerText = "Salvar Alterações";
            })
            .withFailureHandler(function(err) {
                msg.innerText = "Erro ao salvar.";
                msg.style.color = "red";
                btn.disabled = false;
                btn.innerText = "Salvar Alterações";
            })
            .updateUserData(dados);
    });
</script>

</body>
</html>
